<!DOCTYPE html>
<html lang="ar">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>جدول الدروس</title>
    <link rel="stylesheet" href="./css/bootstrap.min.css">
    <script src="./js/bootstrap.bundle.min.js"></script>
</head>

<body class="p-4">

    <h2 class="mb-4 text-center">جدول الدروس</h2>

    <div class="container">

        <!-- زر إضافة يظهر للأدمن فقط -->
        <div id="adminControls" class="mb-3"></div>

        <table class="table table-bordered text-center">
            <thead class="table-dark">
                <tr>
                    <th>اليوم</th>
                    <th>المادة</th>
                    <th>الوقت</th>
                    <th id="actionsHeader"></th>
                </tr>
            </thead>
            <tbody id="tableBody"></tbody>
        </table>

    </div>

    <script>
        const params = new URLSearchParams(window.location.search);
        const isAdmin = params.get("admin") === "123";

        const storageKey = "scheduleTable";
        let rows = JSON.parse(localStorage.getItem(storageKey)) || [];

        const tableBody = document.getElementById("tableBody");
        const adminControls = document.getElementById("adminControls");
        const actionsHeader = document.getElementById("actionsHeader");

        // إظهار زر إضافة لو أدمن
        if (isAdmin) {
            adminControls.innerHTML = `
        <button class="btn btn-primary" onclick="addRow()">إضافة صف</button>
    `;
            actionsHeader.innerText = "إدارة";
        }

        // عرض الجدول
        function renderTable() {
            tableBody.innerHTML = "";

            if (rows.length === 0) {
                tableBody.innerHTML = `
            <tr>
                <td colspan="4" class="text-muted">لا يوجد بيانات بعد</td>
            </tr>
        `;
                return;
            }

            rows.forEach((row, index) => {
                tableBody.innerHTML += `
            <tr>
                <td>${row.day}</td>
                <td>${row.subject}</td>
                <td>${row.time}</td>
                ${isAdmin ? `
                <td>
                    <button class="btn btn-warning btn-sm" onclick="editRow(${index})">تعديل</button>
                    <button class="btn btn-danger btn-sm" onclick="deleteRow(${index})">حذف</button>
                </td>
                ` : ""}
            </tr>
        `;
            });
        }

        // إضافة
        function addRow() {
            const day = prompt("اليوم:");
            const subject = prompt("المادة:");
            const time = prompt("الوقت:");

            if (day && subject && time) {
                rows.push({ day, subject, time });
                localStorage.setItem(storageKey, JSON.stringify(rows));
                renderTable();
            }
        }

        // تعديل
        function editRow(index) {
            const day = prompt("اليوم:", rows[index].day);
            const subject = prompt("المادة:", rows[index].subject);
            const time = prompt("الوقت:", rows[index].time);

            if (day && subject && time) {
                rows[index] = { day, subject, time };
                localStorage.setItem(storageKey, JSON.stringify(rows));
                renderTable();
            }
        }

        // حذف
        function deleteRow(index) {
            if (confirm("هل أنت متأكد من الحذف؟")) {
                rows.splice(index, 1);
                localStorage.setItem(storageKey, JSON.stringify(rows));
                renderTable();
            }
        }

        renderTable();
    </script>

</body>

</html>
<!DOCTYPE html>
<html lang="ar">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>علوم</title>

    <link rel="stylesheet" href="./css/bootstrap.min.css">
    <link rel="stylesheet" href="./style.css">
    <script src="./js/bootstrap.bundle.min.js"></script>
</head>

<body class="p-4">

    <section class="text-center mb-4">
        <h1 class="fw-bold">الفيديوهات</h1>
    </section>

    <div id="cards" class="row"></div>

    <script>
        const container = document.getElementById("cards");
        const params = new URLSearchParams(window.location.search);
        const isAdmin = params.get("admin") === "123";

        // اسم الصفحة الحالي تلقائياً
        const pageName = window.location.pathname.split("/").pop().replace(".html", "");
        const storageKey = pageName + "Cards";

        // جلب البيانات المخزنة
        let cards = JSON.parse(localStorage.getItem(storageKey)) || [];

        // عرض الكروت
        function renderCards() {
            container.innerHTML = "";

            if (cards.length === 0) {
                container.innerHTML = `
                    <div class="col-12 text-center">
                        <p class="text-muted">لا يوجد فيديوهات بعد</p>
                    </div>
                `;
                return;
            }

            cards.forEach((card, index) => {
                container.innerHTML += `
                    <div class="col-md-4 mb-3">
                        <div class="card p-3 shadow-sm">
                            <h5>${card.title}</h5>
                            <a href="${card.link}" target="_blank" class="btn btn-success mb-2">
                                فتح الرابط
                            </a>

                            ${isAdmin ? `
                                <button class="btn btn-warning btn-sm mb-1 w-100" onclick="editCard(${index})">
                                    تعديل
                                </button>
                                <button class="btn btn-danger btn-sm w-100" onclick="deleteCard(${index})">
                                    حذف
                                </button>
                            ` : ""}
                        </div>
                    </div>
                `;
            });
        }

        // حذف كارد
        function deleteCard(index) {
            if (confirm("هل أنت متأكد من الحذف؟")) {
                cards.splice(index, 1);
                localStorage.setItem(storageKey, JSON.stringify(cards));
                renderCards();
            }
        }

        // تعديل كارد
        function editCard(index) {
            const newTitle = prompt("العنوان الجديد:", cards[index].title);
            const newLink = prompt("الرابط الجديد:", cards[index].link);

            if (newTitle && newLink) {
                cards[index] = { title: newTitle, link: newLink };
                localStorage.setItem(storageKey, JSON.stringify(cards));
                renderCards();
            }
        }

        renderCards();
    </script>

</body>

</html>